(function(){var t,e,n,r,s=[].slice,i=function(t,e){return function(){return t.apply(e,arguments)}};if(!Array.prototype.forEach)throw Error("Deferred requires Array.forEach");r=this,n=function(e){return e instanceof Deferred||e instanceof t},e=function(t){var e;return t?(e=[],t.forEach(function(n){return n?"function"==typeof n?e.push(n):t.forEach(function(t){return"function"==typeof t?e.push(t):void 0}):void 0}),e):[]},t=function(){function t(t){this._deferred=t}return t.prototype._deferred=null,t.prototype.always=function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=this._deferred).always.apply(e,t),this},t.prototype.done=function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=this._deferred).done.apply(e,t),this},t.prototype.fail=function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=this._deferred).fail.apply(e,t),this},t.prototype.pipe=function(t,e){return this._deferred.pipe(t,e)},t.prototype.state=function(){return this._deferred.state()},t.prototype.then=function(t,e){return this._deferred.then(t,e),this},t}(),r.Deferred=function(){function Deferred(t){this.then=i(this.then,this),this.resolveWith=i(this.resolveWith,this),this.resolve=i(this.resolve,this),this.rejectWith=i(this.rejectWith,this),this.reject=i(this.reject,this),this.promise=i(this.promise,this),this.progress=i(this.progress,this),this.pipe=i(this.pipe,this),this.notifyWith=i(this.notifyWith,this),this.notify=i(this.notify,this),this.fail=i(this.fail,this),this.done=i(this.done,this),this.always=i(this.always,this),this._state="pending","function"==typeof t&&t.call(this,this)}return Deferred.prototype.always=function(){var t,n,r,i=this;return t=arguments.length>=1?s.call(arguments,0):[],0===t.length?this:(n=e(t),"pending"===this._state?(this._alwaysCallbacks||(this._alwaysCallbacks=[]),(r=this._alwaysCallbacks).push.apply(r,n)):n.forEach(function(t){return t.apply(i._context,i._withArguments)}),this)},Deferred.prototype.done=function(){var t,n,r,i=this;return t=arguments.length>=1?s.call(arguments,0):[],0===t.length?this:(n=e(t),"resolved"===this._state?n.forEach(function(t){return t.apply(i._context,i._withArguments)}):"pending"===this._state&&(this._doneCallbacks||(this._doneCallbacks=[]),(r=this._doneCallbacks).push.apply(r,n)),this)},Deferred.prototype.fail=function(){var t,n,r,i=this;return t=arguments.length>=1?s.call(arguments,0):[],0===t.length?this:(n=e(t),"rejected"===this._state?n.forEach(function(t){return t.apply(i._context,i._withArguments)}):"pending"===this._state&&(this._failCallbacks||(this._failCallbacks=[]),(r=this._failCallbacks).push.apply(r,n)),this)},Deferred.prototype.notify=function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],this.notifyWith.apply(this,[r].concat(s.call(t))),this},Deferred.prototype.notifyWith=function(){var t,e,n;return e=arguments[0],t=arguments.length>=2?s.call(arguments,1):[],"pending"!==this._state?this:(null!=(n=this._progressCallbacks)&&n.forEach(function(n){return n.apply(e,t)}),this)},Deferred.prototype.pipe=function(t,e){var r;return r=new Deferred,this.done(function(){var e,i,a;return e=arguments.length>=1?s.call(arguments,0):[],null!=t?(i=t.apply(this,e),n(i)?i.done(function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=r.resolveWith).call.apply(e,[r,this].concat(s.call(t)))}).fail(function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=r.rejectWith).call.apply(e,[r,this].concat(s.call(t)))}):r.resolveWith.call(r,this,i)):(a=r.resolveWith).call.apply(a,[r,this].concat(s.call(e)))}),this.fail(function(){var t,i,a,l;return t=arguments.length>=1?s.call(arguments,0):[],null!=e?(i=e.apply(this,t),n(i)?i.done(function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=r.resolveWith).call.apply(e,[r,this].concat(s.call(t)))}).fail(function(){var t,e;return t=arguments.length>=1?s.call(arguments,0):[],(e=r.rejectWith).call.apply(e,[r,this].concat(s.call(t)))}):r.rejectWith.call(r,this,i),(a=r.rejectWith).call.apply(a,[r,this].concat(s.call(t)))):(l=r.rejectWith).call.apply(l,[r,this].concat(s.call(t)))}),r.promise()},Deferred.prototype.progress=function(){var t,n,r;return t=arguments.length>=1?s.call(arguments,0):[],0===t.length||"pending"!==this._state?this:(n=e(t),this._progressCallbacks||(this._progressCallbacks=[]),(r=this._progressCallbacks).push.apply(r,n),this)},Deferred.prototype.promise=function(){return this._promise||(this._promise=new t(this))},Deferred.prototype.reject=function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],this.rejectWith.apply(this,[r].concat(s.call(t))),this},Deferred.prototype.rejectWith=function(){var t,e,n,r,i=this;return e=arguments[0],t=arguments.length>=2?s.call(arguments,1):[],"pending"!==this._state?this:(this._state="rejected",this._withArguments=t,this._context=e,null!=(n=this._failCallbacks)&&n.forEach(function(e){return e.apply(i._context,t)}),null!=(r=this._alwaysCallbacks)&&r.forEach(function(e){return e.apply(i._context,t)}),this)},Deferred.prototype.resolve=function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],this.resolveWith.apply(this,[r].concat(s.call(t))),this},Deferred.prototype.resolveWith=function(){var t,e,n,r,i=this;return e=arguments[0],t=arguments.length>=2?s.call(arguments,1):[],"pending"!==this._state?this:(this._state="resolved",this._context=e,this._withArguments=t,null!=(n=this._doneCallbacks)&&n.forEach(function(e){return e.apply(i._context,t)}),null!=(r=this._alwaysCallbacks)&&r.forEach(function(e){return e.apply(i._context,t)}),this)},Deferred.prototype.state=function(){return this._state},Deferred.prototype.then=function(t,e,n){return this.done(t),this.fail(e),this.progress(n),this},Deferred}(),r.Deferred.when=function(){var t,e,n,r;return n=arguments.length>=1?s.call(arguments,0):[],0===n.length?(new Deferred).resolve().promise():1===n.length?n[0].promise():(e=new Deferred,r=0,t=[],n.forEach(function(i,a){return i.done(function(){var i;return i=arguments.length>=1?s.call(arguments,0):[],r+=1,t[a]=i,r===n.length?e.resolve.apply(e,t):void 0}).fail(function(){var t;return t=arguments.length>=1?s.call(arguments,0):[],e.rejectWith.apply(e,[this].concat(s.call(t)))})}),e.promise())},function(){var t,e;return t=window.Zepto,t&&!t.Deferred?(t.Deferred=function(){return new Deferred},e=t.ajax,t.ajax=function(t){var n,r;return r=new Deferred,n=function(t,e){return function(){var n;return n=arguments.length>=1?s.call(arguments,0):[],"function"==typeof t&&t.apply(null,n),e.apply(null,n)}},t.success=n(t.success,r.resolve),t.error=n(t.error,r.reject),e(t),r.promise()}):void 0}()}).call(this);
//@ sourceMappingURL=Deferred.min.map